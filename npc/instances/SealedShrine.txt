//===== rAthena Script ======================================= 
//= Sealed Shrine
//===== By: ================================================== 
//= L0ne_W0lf
//===== Current Version: ===================================== 
//= 2.3
//===== Compatible With: ===================================== 
//= rAthena Project
//===== Description: ========================================= 
//= [Official Conversion]
//= Seal away the Great Demon Baphomet.
//===== Additional Comments: ================================= 
//= 1.0 First version. [L0ne_W0lf]
//= 1.1 Added setquest for instance cooldown. [L0ne_W0lf]
//= 1.2 Fixed Torch#12 not being disabled. (bugreport:4044) [L0ne_w0lf]
//= 1.3 Fixed cutins not being removed. (bugreport:4117) [L0ne_w0lf]
//= 1.4 Fixed some typos. [Gepard]
//= 1.5 Fixed not being able to enter dungeon for the first two hours.
//= 1.6 Players should be able to re-take the quest after 12 hours now.
//=     Changed quest 3046 to 3040. This is the correct quest id.
//=     Removed checking quest 3045, unofficial check.
//= 1.7 Fixed a checkquest condition never setting quest. [L0ne_W0lf]
//= 1.8 Added 'instance_check_party' command to the script for proper checking if
//=     the invoking party meets the requirements to join the Memorial Dungeon.
//= 1.9 Fixed broken else/if chaining. [Joseph]
//= 2.0 Some optimization. [Euphy]
//= 2.1 Fixed quest being removed before the 12 hours cool down. [Joseph]
//= 2.2 Removed extra setquest (quest id:3040).	[Joseph]
//= 2.3 Instance system rewrite. [Euphy]
//============================================================ 

// Sealed Catacomb Entrance
//============================================================
monk_test,309,146,3	script	Friar Patrick#edq	412,{
	cutin "ins_cata_pri_n",2;
	mes "[Friar Patrick]";
	mes "A paz deste mundo não pode durar para sempre ... As mãos do mal estão chegando ao mundo de novo...";
	next;
	mes "[Friar Patrick]";
	mes "O que te trouxe a este lugar?";
	next;
	if (countitem(6004) > 0) {
		set .@doll,1;
		set .@selection,select("O que é este lugar?:Eu quero entrar.:Sobre a boneca amaldiçoada de Baphomet.:Cancelar.");
	}
	else {
		set .@selection,select("O que é este lugar?:Eu quero entrar.:Cancelar.");
	}
	switch(.@selection) {
	case 1:
		mes "[Friar Patrick]";
		mes "Huh ... Você não sabe? Este é o Mosteiro de St. Capitolina, onde os Irmãos que desejam se tornar monges treinam e rezam.";
		next;
		mes "[Friar Patrick]";
		mes "E este lugar é ... O que posso dizer ... sim. É o túmulo do diabo. Grave...";
		next;
		mes "[Friar Patrick]";
		mes "O mesmo lugar onde o grande diabo que uma vez demoliu este mundo está dormindo.";
		next;
		switch(select("Me diga mais.:Pare de falar.")) {
		case 1:
			cutin "ins_cata_pri_n",2;
			mes "[Friar Patrick]";
			mes "Baphomet... é o nome do diabo ... Acho que você já ouviu falar do nome dele.";
			next;
			mes "[Friar Patrick]";
			mes "Numerosos homens e irmãos corajosos treinaram neste mosteiro...";
			next;
			mes "[Friar Patrick]";
			mes "Sob esta lápide à sua frente ... Baphomet está selado.";
			next;
			mes "[Friar Patrick]";
			mes "Mas ... Enquanto falamos Satanás, Morocc está organizando sua poderosa magia para afetar toda a vida neste continente.";
			next;
			mes "[Friar Patrick]";
			mes "Baphomet também... despertou e está se preparando para o seu reavivamento, para este mundo, enfraquecendo o poder do selo através do poder de Satanás....";
			next;
			mes "[Friar Patrick]";
			mes "Agora... Estou procurando alguém corajoso o suficiente para selar Baphomet em seu santuário... como já fizemos muitos anos atrás...";
			next;
			mes "[Friar Patrick]";
			mes "Qualquer um que lute pelo bem saberá, no fundo, que o mal está ameaçando conquistar este mundo...";
			next;
			mes "[Friar Patrick]";
			mes "Treine mais e use suas habilidades para proteger o mundo da presença iminente do mal...";
			break;
		case 2:
			cutin "ins_cata_pri_n",2;
			mes "[Friar Patrick]";
			mes "Qualquer um que lute pelo bem saberá, no fundo, que o mal está ameaçando conquistar este mundo...";
			next;
			mes "[Friar Patrick]";
			mes "Treine mais e use suas habilidades para proteger o mundo da presença iminente do mal...";
			break;
		}
		break;
	case 2:
		if (BaseLevel >= 75) {

			set .@party_id,getcharid(1);

			mes "[Friar Patrick]";
			mes "Você quer dizer que irá ao santuário e selará Baphomet?";
			next;

			// 12 hour cooldown
			set .@ins_bapho_check,checkquest(3040,PLAYTIME);
			// Two hour play limit
			//set .@ins_bapho_check2,checkquest(3045,PLAYTIME);

			if (.@ins_bapho_check == -1) {
				if (getpartyleader(.@party_id,2) == getcharid(0) && instance_check_party(.@party_id,2,75)) {
					mes "[Friar Patrick]";
					mes "Nome do seu grupo é "+getpartyname(.@party_id)+"...";
					mes "O nome do líder é "+strcharinfo(0)+"...";
					if (instance_create("Sealed Catacomb") < 0) {
						mes "Humm... Mas parece que há um problema aqui... vou checar rapidamente. Por favor, espere.";
					}
					else {
						mes "Ok... Vou ajustar o selo do santuário para que você e seu grupo possam entrar.";
						next;
						mes "[Friar Patrick]";
						mes "Você verá um sinal quando o selo estiver quebrado. Por favor, espere até que o sinal apareça...";
						next;
						mes "[Friar Patrick]";
						mes "Quando você ver o sinal, coloque suas mãos na lápide... Então você pode se mover para dentro.";
						next;
						mes "[Friar Patrick]";
						mes "Uma coisa que você deve lembrar é... Qualquer um que entrar neste santuário será amaldiçoado por Baphomet e não poderá entrar ou sair enquanto eles forem amaldiçoados.";
						next;
						mes "[Friar Patrick]";
						mes "E mais uma coisa... Nessa área amaldiçoada, algumas habilidades, que são protegidas pela energia física externa, são proibidas pelo efeito do selo.";
						next;
						mes "[Friar Patrick]";
						mes "Por exemplo, as habilidades como ^0000FFSafety Wall e Assumptio^000000... Então é melhor você se preparar antes de entrar no santuário.";
					}
				}
				else {
					mes "[Friar Patrick]";
					mes "Humm... reconheço sua coragem, mas... não posso permitir que alguém entre neste lugar. Eu só posso permitir que o líder de um grupo entre primeiro.";
					next;
					mes "[Friar Patrick]";
					mes "Uma vez que o líder do grupo é permitido, o resto da parte pode entrar. Esta é uma regra deste mosteiro, então por favor entenda.";
				}
			}
			else if (.@ins_bapho_check == 0 || .@ins_bapho_check == 1) {
				mes "[Friar Patrick]";
				mes "Parece que você entrou neste santuário recentemente... Você não pode voltar porque a Maldição de Baphomet ainda permanece. A Maldição de Baphomet desaparece somente depois de um certo período de tempo.";
			}
			else if (.@ins_bapho_check == 2) {
				mes "[Friar Patrick]";
				mes "Humm... Parece que a Maldição de Baphomet enfraqueceu. Eu posso removê-lo agora.";
				next;
				mes "[Friar Patrick]";
				mes "Haaaaaaap... Hocus Pocus Wingardium Abracadabra!!!!!";
				next;
				erasequest 3040;
				if (checkquest(3041)>=0) erasequest 3041;
				if (checkquest(3045)>=0) erasequest 3045;
				mes "[Friar Patrick]";
				mes "Huu... acabou. Agora que eu liberei Baphomet's Curse, você pode entrar novamente.";
			}
		}
		else {
			mes "[Friar Patrick]";
			mes "Umm... Você deve treinar mais para entrar neste lugar perigoso... Você deve alcançar pelo menos o nível 75 para entrar aqui.";
			next;
			mes "[Friar Patrick]";
			mes "Por favor, treine mais e volte.";
		}
		break;
	case 3:
		if (.@doll == 1) {
			mes "[Friar Patrick]";
			mes "Isso é... a boneca vilã que você está segurando... Deixe-me ver.";
			next;
			mes "[Friar Patrick]";
			mes "... ... ...";
			next;
			mes "[Friar Patrick]";
			mes "Isso é correto... Eu posso sentir o mal de Baphomet por dentro... Então, o que você vai fazer com a boneca?";
			next;
			mes "[Friar Patrick]";
			mes "É apenas uma coisa perigosa e inútil se você não fizer nada com isso... Vou apresentar alguém que possa ajudá-lo... Você quer vê-lo?";
			next;
			mes "[Friar Patrick]";
			mes "Vá ver ^0000FFRust Blackhand^000000 que está perto do edifício principal do mosteiro... Ele fará este boneco útil para você.";
			setquest 3042;
			break;
		}
	case 4:
		mes "[Friar Patrick]";
		mes "Qualquer um que lute pelo bem saberá, no fundo, que o mal está ameaçando conquistar este mundo...";
		next;
		mes "[Friar Patrick]";
		mes "Treine mais e use suas habilidades para proteger o mundo da presença iminente do mal...";
		break;
	}
	close2;
	cutin "",255;
	end;
}

monk_test,306,151,3	script	Túmulo de Baphomet#edq	111,{
	if (countitem(6002)) delitem 6002,countitem(6002); //Token_Of_Apostle
	mes "Esta lápide tem uma escultura de um diabo mau com grandes chifres. Isso desperta um sentimento sinistro.";
	next;
	if(select("Toque na pedra.:Recuar.") == 2)
		close;

	// 12 hour cooldown
	set .@ins_bapho_check,checkquest(3040,PLAYTIME);
	// Two hour play limit
	//set .@ins_bapho_check2,checkquest(3045,PLAYTIME);

	if (.@ins_bapho_check == -1) {
		switch(instance_enter("Sealed Catacomb")) {
		case IE_OTHER:
		case IE_NOINSTANCE:
			mes "Está frio ao toque. Não responde.";
			close;
		case IE_NOMEMBER:
			mes "[Friar Patrick]";
			mes "Para entrar neste lugar perigoso, você não pode ir sozinho. Venha novamente depois de se juntar a um grupo.";
			close;
		case IE_OK:
			mapannounce "monk_test","[" + strcharinfo(0) + "] membro de [" + getpartyname(.@party_id) + "] entrou no Santuário Selado.",bc_map,"0x00ff99";
			setquest 3040;
			//warp "1@cata",100,224;
			close;
		}
	} else if (.@ins_bapho_check == 0 || .@ins_bapho_check == 1) {
		mes "[Friar Patrick]";
		mes "Parece que você entrou neste santuário recentemente... Você não pode voltar porque a maldição de Baphomet ainda permanece.";
		mes "A maldição de Baphomet desaparece depois de um certo tempo depois que você entrou.";
		close;
	} else if (.@ins_bapho_check == 2) {
		mes "[Friar Patrick]";
		mes "Humm... Parece que a maldição de Baphomet enfraqueceu. Eu vou limpar a maldição ruim.";
		next;
		mes "[Friar Patrick]";
		mes "Haaaaaaap... Wingardium Leviosa Expecto Patronum !!!!!";
		specialeffect2 EF_HOLYHIT;
		erasequest 3040;
		if (checkquest(3041)>=0) erasequest 3041;
		if (checkquest(3045)>=0) erasequest 3045;
		next;
		mes "[Friar Patrick]";
		mes "Huu... acabou. Agora eu soltei todas as maldições em você. Você pode entrar novamente.";
		close;
	}
}

prt_monk,261,91,3	script	Rust Blackhand#edq	826,{
	set .@new_maje,checkquest(3043);
	mes "[Rust Blackhand]";
	mes "Quem é Você? O que você me quer comigo?";
	next;
	mes "[Rust Blackhand]";
	mes "Você não é um monge, então o que você quer?";
	next;
	if (.@new_maje == 0 || .@new_maje == 1) {
		mes "[Rust Blackhand]";
		mes "Você trouxe todos os ingredientes?";
		next;
		if ((countitem(6004) > 0) && (countitem(2256) > 0) && (countitem(7799) > 29) && (countitem(7798) > 49) && (Zeny > 990000)) {
			mes "[Rust Blackhand]";
			mes "kkk... Você preparou bem os ingredientes. Por que você não deixa lá e espera?";
			next;
			mes "[Rust Blackhand]";
			mes "Hmm... Faz tanto tempo desde a última vez que vi esses chifres maus... kkk... Deixe-me começar...";
			next;
			mes "...";
			next;
			mes "... ...";
			next;
			mes "... ... ...";
			next;
			delitem 6004,1; //Bapho_Doll
			delitem 2256,1; //Magestic_Goat
			delitem 7799,30; //Dark_Crystal
			delitem 7798,50; //Dark_Debris
			set Zeny, Zeny-990000;
			completequest 3043;
			getitem 5374,1; //L_Magestic_Goat
			mes "[Rust Blackhand]";
			mes "Está feito. Você pode estar animado, claro. Compreendo...";
			next;
			mes "[Rust Blackhand]";
			mes "Não aceito reclamações ou solicitações de A a Z, portanto, use-as com cuidado. Eu preciso ir...";
			close;
		}
		else {
			mes "[Rust Blackhand]";
			mes "Huu... Você não entende o que eu disse. Você não pode fazer nada com esses ingredientes.";
			next;
			mes "[Rust Blackhand]";
			mes "Vou te contar os ingredientes mais uma vez, então, por favor, colete-os corretamente.";
			next;
			mes "[Rust Blackhand]";
			mes "^0000FFBoneco de Bafomé Maldito, Chifres Majestosos, 30 Cristal da Escuridão, 50 Fragmento da Escuridão^000000, e o mais importante, o custo de produção é de ^0000FF990000^000000 Zeny.";
			close;
		}
	}
	else if ((.@new_maje == -1) && (countitem(6004) > 0)) {
		switch(select("Sobre o Boneco de Bafomé Maldito:Para Conversa.")) {
		case 1:
			mes "[Rust Blackhand]";
			mes "O que?... Hmmm... Você conseguiu o boneco? Você é muito bom, ao contrário da sua aparência...";
			next;
			mes "[Rust Blackhand]";
			mes "Deixe-me ver... Escusado será dizer que Patric deve ter enviado você aqui para lidar com a boneca, certo?";
			next;
			mes "[Rust Blackhand]";
			mes "Legal... Eu te ajudarei a tornar o Boneco de Bafomé Maldito útil. O que? O que eu posso fazer?";
			next;
			mes "[Rust Blackhand]";
			mes "Eu posso fazer os chifres fortes e grandes do diabo mau Baphomet para você. Um elmo que tem seu imenso poder.";
			next;
			mes "[Rust Blackhand]";
			mes "É chamado de ^4d4dffChifres Majestosos Gigantes^000000. Você vai perceber que o Chifres Majestosos com o qual você está familiarizado não é nada em comparação.";
			next;
			mes "[Rust Blackhand]";
			mes "O Boneco de Bafomé Maldito é o ingrediente mais importante... Eu vou fazer você se quiser. O que você gostaria de fazer?";
			next;
			switch(select("Eu quero fazer um!:Eu não preciso de um.")) {
			case 1:
				mes "[Rust Blackhand]";
				mes "kkk... Sim, homens sábios arriscam quando a oportunidade chega. Eu vou te contar os ingredientes. Não esqueça, e traga todos eles.";
				next;
				mes "[Rust Blackhand]";
				mes "^0000FFBoneco de Bafomé Maldito, Chifres Majestosos, 30 Cristal da Escuridão, 50 Fragmento da Escuridão^000000, e o mais importante, o custo de produção é de ^0000FF990000^000000 Zeny.";
				next;
				mes "[Rust Blackhand]";
				mes "Você pode pegar o Chifres Majestosos do fraco Baphomet na Floresta do Labirinto. Cristal da Escuridão e Fragmento da Escuridão são da Encarnação de Morroc.";
				next;
				mes "[Rust Blackhand]";
				mes "Tenho certeza de que você pode obter os ingredientes porque selou o verdadeiro Baphomet. Você não pode? kkk...";
				next;
				mes "[Rust Blackhand]";
				mes "Você nunca saberá como esse chapéu é ótimo até conseguir um. Se você entendeu, vá e pegue os ingredientes.";
				if (isbegin_quest(3042))
					changequest 3042,3043;
				else
					setquest 3043;
				close;
			case 2:
				mes "[Rust Blackhand]";
				mes "Huh... E você? Faça o que quiser... Você realmente quer deixar essa oportunidade desperdiçar?";
				next;
				mes "[Rust Blackhand]";
				mes "Tut, tut... Eu não me importo se o boneco malvado ameaça sua vida o tempo todo!";
				close;
			}
		case 2:
			mes "[Rust Blackhand]";
			mes "Que menino chato ele é... huh...";
			close;
		}
	}
	else if ((.@new_maje == -1) && (countitem(6004) == 0)) {
		mes "[Rust Blackhand]";
		mes "Se você não tem negócios comigo, vá embora! Como você vê, eu faço equipamentos para os Irmãos no mosteiro, não para aventureiros como você. Voce entende?";
		close;
	}
	else if ((.@new_maje == 2) && (countitem(6004) > 0)) {
		switch(select("Sobre o Boneco de Bafomé Maldito:Para Conversa.")) {
		case 1:
			mes "[Rust Blackhand]";
			mes "O que?... Você de novo? O que você quer desta vez?";
			next;
			mes "[Rust Blackhand]";
			mes "O quê? Você tem outro boneco do diabo mau? Umm... Você é muito melhor do que eu pensava...";
			next;
			mes "[Rust Blackhand]";
			mes "Tudo bem... eu vou te ajudar de novo.";
			next;
			mes "[Rust Blackhand]";
			mes "Se você quiser fazer o boneco em um ^4d4dffChifres Majestosos Gigantes^000000 novamente, eu posso fazer outra.";
			next;
			mes "[Rust Blackhand]";
			mes "Eu vou te contar os ingredientes novamente. Então, você quer fazer?";
			next;
			switch(select("Eu quero.:Não, não quero.")) {
			case 1:
				mes "[Rust Blackhand]";
				mes "kkk... Sim, homens sábios arriscam quando a oportunidade chega. Eu vou te contar os ingredientes. Não esqueça, e traga todos eles.";
				next;
				mes "[Rust Blackhand]";
				mes "^0000FFBoneco de Bafomé Maldito, Chifres Majestosos, 30 Cristal da Escuridão, 50 Fragmento da Escuridão^000000, e o mais importante, o custo de produção é de ^0000FF990000^000000 Zeny.";
				next;
				mes "[Rust Blackhand]";
				mes "Você pode pegar o Chifres Majestosos do fraco Baphomet na Floresta do Labirinto. Cristal da Escuridão e Fragmento da Escuridão são da Encarnação de Morroc.";
				next;
				mes "[Rust Blackhand]";
				mes "Tenho certeza de que você pode obter os ingredientes porque selou o verdadeiro Baphomet. Você não pode? kkk...";
				next;
				mes "[Rust Blackhand]";
				mes "Você nunca saberá como esse chapéu é ótimo até conseguir um. Se você entendeu, vá e pegue os ingredientes.";
				//recall_completequest 3043
				if (isbegin_quest(3042))
					changequest 3042,3043;
				else {
					erasequest 3043;
					setquest 3043;
				}
				close;
			case 2:
				mes "[Rust Blackhand]";
				mes "Huh... E você? Faça o que quiser... Você realmente quer deixar essa oportunidade desperdiçar?";
				next;
				mes "[Rust Blackhand]";
				mes "Tut, tut... Eu não me importo se o boneco malvado ameaça sua vida o tempo todo!";
				close;
			}
		case 2:
			mes "[Rust Blackhand]";
			mes "Que menino chato ele é... huh...";
			close;
		}
	}
	else if ((.@new_maje == 2) && (countitem(6004) == 0)) {
		mes "[Rust Blackhand]";
		mes "Por que você está andando por aqui? Se você não quer um ^4d4dffChifres Majestosos Gigantes^000000 , vá embora.";
		close;
	}
}

// Sealed Shrine Interior
//============================================================
1@cata,1,2,0	script	ins_baphomet_lotto	-1,{
OnInstanceInit:
	// Pick one "true" Gravestone and 12 "false" Gravestones.
	set .@true, rand(1,13);
	for(set .@i,1; .@i<=13; set .@i,.@i+1) {
		disablenpc instance_npcname("Gravestone#1F_"+.@i+((.@i == .@true)?"T":"F"));
	}
	disablenpc instance_npcname("ins_baphomet_lotto");
	end;
}

1@cata,3,2,0	script	ins_baphomet_lotto2	-1,{
OnEnable:
	for(set .@i,1; .@i<=12; set .@i,.@i+1)
		enablenpc instance_npcname("Bobbing Torch#"+.@i);
	end;
}

1@cata,4,2,0	script	ins_baphomet_lotto3	-1,{
OnEnable:
	set .@label$, instance_npcname("ins_baphomet_lotto3")+"::OnMyMobDead";
	set .@map$, instance_mapname("1@cata");
	monster .@map$,0,0,"Apóstolo de Baphomet",1869,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1291,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1869,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1291,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1869,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1291,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1869,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1132,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1117,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1132,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1117,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1132,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1291,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1117,1,.@label$;
	monster .@map$,0,0,"Apóstolo de Baphomet",1869,1,.@label$;
	end;

OnDisable:
	killmonster instance_mapname("1@cata"),instance_npcname("ins_baphomet_lotto3")+"::OnMyMobDead";
	end;

OnMyMobDead:
	set .@map$, instance_mapname("1@cata");
	if (mobcount(.@map$,instance_npcname("ins_baphomet_lotto3")+"::OnMyMobDead") < 1) {
		mapannounce .@map$, "All apostles of Baphomet are dead!",bc_map,"0x00ff99";
	}
	getitem 6002,1; //Token_Of_Apostle
	end;
}

// Soul of hero near the north grave
//============================================================
1@cata,141,221,0	script	Gravestone#	844,3,3,{
	set .@party_id,getcharid(1);
	if ('ins_baphomet == 0) {
		mes "A lápide está tremendo...";
		next;
		mes "Ao tocar a lápide, ouço uma voz.";
		next;
		specialeffect2 EF_CONE;
		mes "[Voz da Lápide]";
		mes "Eu esperei e esperei por um bravo aventureiro como você, que voltará aqui de novo...";
		next;
		while(1) {
			switch(select("Quem é Você?:Esperou por mim?:Cancelar.")) {
			case 1:
				mes "[Voz da Lápide]";
				mes "Eu era um dos guerreiros para parar Baphomet como você. Agora, eu estou morto e só minha alma permanece...";
				next;
				mes "[Voz da Lápide]";
				mes "Como você sabe... Nós não temos muito tempo. Você não pode parar Baphomet por si mesmos. O poder do diabo se fortaleceu ao longo dos anos.";
				next;
				mes "[Voz da Lápide]";
				mes "No passado, meus companheiros e eu selamos Baphomet no altar localizado no segundo porão e bloqueamos a entrada.";
				next;
				mes "[Voz da Lápide]";
				mes "Eu mudei a essência da minha alma para o meu pingente, para que eu pudesse permanecer neste mundo. Foi quando eu me tornei o guardião da sepultura.";
				next;
				break;
			case 2:
				mes "[Voz da Lápide]";
				mes "O poder de Baphomet está prestes a quebrar o selo que nós fizemos. Se você não reativá-los... o reavivamento de Baphomet será apenas uma questão de tempo.";
				next;
				mes "[Voz da Lápide]";
				mes "Para abrir a entrada, você deve substanciar minha alma. Eu vou abrir a entrada e reativar os selos enfraquecidos depois que eu estiver substanciado.";
				next;
				mes "[Voz da Lápide]";
				mes "Para substanciar minha alma, você deve encontrar meu pingente. Você pode encontrar meu corpo perto de uma sepultura aqui.";
				next;
				mes "[Voz da Lápide]";
				mes "Se seu ^0000FFLider do Grupo^000000 traz-me o pingente, minha alma pode ser substancializada. Então, se apresse.";
				set 'ins_baphomet,1;
				close;
			case 3:
				mes "Eu posso sentir a voz se tornando fraca.";
				close;
			}
		}
	}
	else if ('ins_baphomet == 1) {
		mes "[Voz da Lápide]";
		mes "Para abrir a entrada, você deve substancializar minha alma. Abrirei a entrada e reativei os selos enfraquecidos depois de ser substanciada.";
		next;
		mes "[Voz da Lápide]";
		mes "Para substanciar minha alma, você deveria encontrar meu pingente. Você pode encontrar meu corpo perto de uma sepultura aqui.";
		next;
		mes "[Voz da Lápide]";
		mes "Se seu ^0000FFLider do Grupo^000000 traz-me o pingente, minha alma pode ser substancializada. Então, se apresse.";
		close;
	}
	else if (('ins_baphomet == 2) && (getpartyleader(.@party_id,2) == getcharid(0))) {
		mes "[Voz da Lápide]";
		mes "Você achou o pingente?";
		next;
		if (countitem(6003) > 0) {
			specialeffect EF_MAPPILLAR;
			mes "[Voz da Lápide]";
			mes "Sim... isso é... meu pingente...";
			next;
			delitem 6003,1; //Soul_Pendant
			enablenpc instance_npcname("Alma do Heroi Antigo#1F");
			disablenpc instance_npcname("Gravestone#");
			mes "[Voz da Lápide]";
			mes "Agora eu posso substanciar minha alma. Eu vou esperar por você na frente do altar de fogo localizado no centro desta sepultura. Vamos nos encontrar lá.";
			next;
			mapannounce instance_mapname("1@cata"), "Alma do Heroi Antigo: Eu vou esperar por você na frente do altar de fogo localizado no centro",bc_map,"0xFFFF00";
			mes "Eu posso sentir a voz se tornando fraca.";
			close;
		}
		else {
			mes "[Voz da Lápide]";
			mes "Você ainda está aí? Traga de volta meu pingente o mais rápido possível.";
			next;
			mes "[Voz da Lápide]";
			mes "Você pode encontrar meu corpo perto de uma sepultura aqui. Vá e pegue meu pingente lá.";
			close;
		}
	}
	else {
		mes "[Voz da Lápide]";
		mes "eu quero falar com ^0000FFum representante do seu grupo^000000. Todos os outros, esperem aqui.";
		close;
	}
	end;

OnTouch:
	if ('ins_baphomet == 0) {
		mes "'Krrrr... Krrrr...'";
		next;
		mes "Eu posso sentir algo estranho no túmulo. É como se alguém estivesse falando em silêncio...";
		close;
	}
	end;

OnInstanceInit: // Temporary fix for @reloadscript.
	set 'ins_baphomet,0;
	end;
}

1@cata,176,119,4	script	Alma do Heroi Antigo#1F	411,{
	set .@party_id,getcharid(1);
	cutin "ins_cata_champ_n",2;
	if ('ins_baphomet == 2) {
		mes "[Alma do Heroi Antigo]";
		mes "Com sua ajuda, minha alma pode ser substancializada. Eu quero falar mais, mas não temos tempo suficiente ...";
		next;
		mes "[Alma do Heroi Antigo]";
		mes "Eu devo ser substancializado na próxima hora. Para chegar ao subsolo principal, você deve me ajudar a realizar a cerimônia de abertura de cada selo.";
		next;
		mes "[Alma do Heroi Antigo]";
		mes "Agora eu vou te dizer o que você deve fazer. Primeiro, colecione ^0000FFEssência de Fogo^000000 das tochas nas sepulturas...";
		next;
		mes "[Alma do Heroi Antigo]";
		mes "Em segundo lugar, todos os membros que entrarem no submundo devem portar um símbolo, chamado de Símbolo do Apóstolo.";
		next;
		while(1) {
			cutin "ins_cata_champ_n",2;
			switch(select("O que é Essência de fogo?:O que é um símbolo do apóstolo?:O que devo fazer?:Estou pronto.")) {
			case 1:
				set .@ins_baphomet_1f_1,.@ins_baphomet_1f_1+1;
				mes "[Alma do Heroi Antigo]";
				mes "Você pode ver as tochas aqui e ali. Essas tochas são a essência de Thor, o deus do trovão. Eles são herdados de nossos antecessores para parar a escuridão de Baphomet...";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "Para abrir o portão subterrâneo lacrado, devo ser purificado pela a ^0000FFEssência do Fogo^000000 que tem o poder de Thor. Recolher ^0000FF10 Essência do Fogo^000000 das tochas.";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "Uma coisa que você deve lembrar é... ^0000FFEssência do Fogo^000000 só pode ser coletado pelo Herdeiro da Fé.";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "Eu darei o sinal do Herdeiro da Fé ao líder do grupo. Apenas o líder do grupo pode coletar a ^0000FFEssência do Fogo^000000.";
				next;
				break;
			case 2:
				set .@ins_baphomet_1f_2,.@ins_baphomet_1f_2+1;
				mes "[Alma do Heroi Antigo]";
				mes "Naquela época, era impossível se livrar de Devil Baphomet por nós mesmos. Depois que inúmeros heróis sacrificaram suas vidas, nós mal pudemos selá-lo sob essa abadia.";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "No entanto, Baphomet nunca desistiu. Ele continuamente fortaleceu seu poder. E seu poder trouxe nova vida a este santuário.";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "Alguns desses monstros têm poderes mágicos. Baphomet os chama de seus 'apóstolos'.";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "Os apóstolos estão se clonando para encher o santuário com sua energia maligna. Eles são os monstros aqui nesta catacumba.";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "Mate os apóstolos. Eles só podem ser distinguidos de seus clones porque eles possuem um ^0000FFSímbolo do Apóstolo^000000...";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "Se cada membro do grupo possuir o ^0000FFSímbolo do Apóstolo^000000, Baphomet não será capaz de perceber sua entrada no subterrâneo do Altar Principal.";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "Se Baphomet perceber você quando você passar pelo portão selado, ele poderá liberar seu tremendo poder mágico. Então, esta abadia será demolida.";
				next;
				mes "[Alma do Heroi Antigo]";
				mes "Mate os apóstolos e obtenha o ^0000FFSímbolo do Apóstolo^000000.";
				next;
				break;
			case 3:
				set .@ins_baphomet_1f_3,.@ins_baphomet_1f_3+1;
				if (getpartyleader(.@party_id,2) == getcharid(0)) {
					mes "[Alma do Heroi Antigo]";
					mes "You look like the leader of this party. You need to go and get ^0000FF10 Essence of Fire^000000 from the torches.";
					next;
					mes "[Alma do Heroi Antigo]";
					mes "Now I'll carve you the symbol which shows you're a inheritor of faith. Be aware that no one in your party but you can collect the Essence of Fire.";
					next;
					specialeffect2 EF_HOLYHIT;
					mes "[Alma do Heroi Antigo]";
					mes "You should also carry a ^0000FFToken of Apostle^000000, so find one for yourself too.";
					next;
					mes "[Alma do Heroi Antigo]";
					mes "When all of you are ready to go, let me know. I'll open the sealed gate when you're ready.";
					next;
				}
				else {
					mes "[Alma do Heroi Antigo]";
					mes "Make sure that your party leader has listened to my explanation of what you and your companions must do.";
					next;
					mes "[Alma do Heroi Antigo]";
					mes "Kill the Apostles of Baphomet and find their ^0000FFToken of Apostle^000000.";
					next;
					mes "[Alma do Heroi Antigo]";
					mes "It might be better to kill all of them because there is no way to differentiate them from their clones.";
					next;
					mes "[Alma do Heroi Antigo]";
					mes "Are you ready?";
					mes "Make sure that you have listened to all that I have to say before saying that you are ready.";
					next;
				}
				break;
			case 4:
				if ((.@ins_baphomet_1f_1 > 0) && (.@ins_baphomet_1f_2 > 0) && (.@ins_baphomet_1f_3 > 0)) {
					cutin "ins_cata_champ_n",2;
					mes "[Alma do Heroi Antigo]";
					mes "Are you ready to go? Then I'll open this sealed gate now.";
					next;
					set .@exitloop,1;
				}
				else {
					cutin "ins_cata_champ_a",2;
					mes "[Alma do Heroi Antigo]";
					mes "It may be difficult but I wish you luck braving the perils of this catacomb.";
					next;
					mes "[Alma do Heroi Antigo]";
					mes "Remember, you need to collect ^0000FF10 Essence of Fire^000000 from the torches and the ^0000FFToken of Apostle^000000 from the Apostles of Baphomet.";
					next;
				}
				break;
			}
			if (.@exitloop) break;
		}
		if (getpartyleader(.@party_id,2) == getcharid(0)) {
			mes "[Alma do Heroi Antigo]";
			mes "To remind you again, I must be substantialized within the next hour. So everyone, finish your work within that time!";
			set 'ins_baphomet,3;
			donpcevent instance_npcname("ins_baphomet_1f_timer")+"::OnEnable";
			donpcevent instance_npcname("ins_baphomet_lotto2")+"::OnEnable";
			donpcevent instance_npcname("ins_baphomet_lotto3")+"::OnEnable";
		}
		else {
			mes "[Alma do Heroi Antigo]";
			mes "To remind you again, I can be substantialized for the next hour. So everyone, finish your work within that time.";
			//set 'ins_baphomet,3;
		}
		close2;
		cutin "",255;
		end;
	}
	else if (('ins_baphomet == 3) && (getpartyleader(.@party_id,2) == getcharid(0))) {
		cutin "ins_cata_champ_n",2;
		mes "[Alma do Heroi Antigo]";
		mes "Did you get 10 ^0000FFEssence of Fire^000000 and ^0000FFToken of Apostle^000000?";
		next;
		if ((countitem(6001) > 9) && (countitem(6002) > 0)) {
			delitem 6001,countitem(6001); //Essence_Of_Fire
			set 'ins_baphomet,4;
			mes "[Alma do Heroi Antigo]";
			mes "Okay. You've done your work. Now check your companions and tell me when everyone has finished their work.";
		}
		else {
			mes "[Alma do Heroi Antigo]";
			mes "Not ready yet? You should prepare 10 ^0000FFEssence of Fire^000000 and ^0000FFToken of Apostle^000000.";
		}
		close2;
		cutin "",255;
		end;
	}
	else if ('ins_baphomet == 3) {
		cutin "ins_cata_champ_n",2;
		mes "[Alma do Heroi Antigo]";
		mes "Do you have a ^0000FFToken of Apostle^000000?";
		next;
		if (countitem(6002) > 0) {
			set 'ins_baphomet,4;
			mes "[Alma do Heroi Antigo]";
			mes "Okay. You've done your work. Tell your representative to check your companions and come to me when everyone has finished their work.";
		}
		else {
			mes "[Alma do Heroi Antigo]";
			mes "Not ready yet? You should prepare ^0000FFToken of Apostle^000000.";
		}
		close2;
		cutin "",255;
		end;
	}
	else if (('ins_baphomet == 4) && (getpartyleader(.@party_id,2) == getcharid(0))) {
		cutin "ins_cata_champ_n",2;
		mes "[Alma do Heroi Antigo]";
		mes "Are you ready? I opened the sealed gate. To pass the gate, you should carry a ^0000FFToken of Apostle^000000.";
		next;
		set 'ins_baphomet,5;
		specialeffect EF_TELEPORTATION;
		enablenpc instance_npcname("ins_bapho_to_2f");
		mes "[Alma do Heroi Antigo]";
		mes "Now you can go to the main altar. It is located in the bottom right corner of this floor.";
		next;
		mes "[Alma do Heroi Antigo]";
		mes "Your real battle will begin... I'll follow you soon and find a way to help you.";
		next;
		mes "[Alma do Heroi Antigo]";
		mes "Go ahead, warriors.";
		cutin "",255;
		mapannounce instance_mapname("1@cata"), "Alma do Heroi Antigo : Now you can go to the Main Altar's gate. It is located in the Southeast",bc_map,"0xFFFF00";
		close;
	}
	else if ('ins_baphomet == 4) {
		cutin "ins_cata_champ_n",2;
		mes "[Alma do Heroi Antigo]";
		mes "Are you ready? I opened the sealed gate. To pass the gate, you should carry a ^0000FFToken of Apostle^000000.";
		next;
		mes "[Alma do Heroi Antigo]";
		mes "I'll complete opening the sealed gate when your representative tells me that you're ready.";
		cutin "",255;
		close;
	}
	else if ('ins_baphomet == 5) {
		cutin "ins_cata_champ_n",2;
		mes "[Alma do Heroi Antigo]";
		mes "What are you doing? The entrance of the main altar is opened now, go and fight! The entrance is near the bottom right side of this floor.";
		cutin "",255;
		close;
	}
	else {
		cutin "ins_cata_champ_n",2;
		mes "[Alma do Heroi Antigo]";
		mes "I have nothing to say to you...";
		cutin "",255;
		close;
	}

OnInstanceInit:
	disablenpc instance_npcname("Alma do Heroi Antigo#1F");
	end;
}

// To 2F Warp
//============================================================
1@cata,281,12,0	script	ins_bapho_to_2f	45,1,1,{
OnTouch:
	if (countitem(6002) > 0) {
		delitem 6002,countitem(6002); //Token_Of_Apostle
		set 'ins_baphomet,5;
		warp instance_mapname("2@cata"),80,144;
		end;
	}
	else {
		mes "[Alma do Heroi Antigo]";
		mes "Onde está o seu símbolo de apóstolo? Eu disse que você deveria levar o símbolo do apóstolo para passar por este portão.";
		close;
	}

OnInstanceInit:
	disablenpc instance_npcname("ins_bapho_to_2f");
	end;
}

// Gravestones
//============================================================
-	script	Gravestone#SS1	-1,{
	if ('ins_baphomet == 1) {
		getitem 6003,1; //Soul_Pendant
		set 'ins_baphomet,2;
		mes "A small object is shining under a leaning grave.";
		next;
		mes "[" + strcharinfo(0) + "]";
		mes "I think this is the pendant...";
		close;
	}
	else {
		mes "I can only feel gloom from this Gravestone.";
		close;
	}
}
1@cata,86,214,0	duplicate(Gravestone#SS1)	Gravestone#1F_1T	844
1@cata,200,209,0	duplicate(Gravestone#SS1)	Gravestone#1F_2T	844
1@cata,230,195,0	duplicate(Gravestone#SS1)	Gravestone#1F_3T	844
1@cata,118,182,0	duplicate(Gravestone#SS1)	Gravestone#1F_4T	844
1@cata,193,182,0	duplicate(Gravestone#SS1)	Gravestone#1F_5T	844
1@cata,253,156,0	duplicate(Gravestone#SS1)	Gravestone#1F_6T	844
1@cata,88,154,0	duplicate(Gravestone#SS1)	Gravestone#1F_7T	844
1@cata,127,116,0	duplicate(Gravestone#SS1)	Gravestone#1F_8T	844
1@cata,90,98,0	duplicate(Gravestone#SS1)	Gravestone#1F_9T	844
1@cata,188,84,0	duplicate(Gravestone#SS1)	Gravestone#1F_10T	844
1@cata,244,42,0	duplicate(Gravestone#SS1)	Gravestone#1F_11T	844
1@cata,127,32,0	duplicate(Gravestone#SS1)	Gravestone#1F_12T	844
1@cata,267,30,0	duplicate(Gravestone#SS1)	Gravestone#1F_13T	844

-	script	Gravestone#SS2	-1,{
	mes "I can only feel gloom from this Gravestone.";
	close;
}
1@cata,86,214,0	duplicate(Gravestone#SS2)	Gravestone#1F_1F	844
1@cata,200,209,0	duplicate(Gravestone#SS2)	Gravestone#1F_2F	844
1@cata,230,195,0	duplicate(Gravestone#SS2)	Gravestone#1F_3F	844
1@cata,118,182,0	duplicate(Gravestone#SS2)	Gravestone#1F_4F	844
1@cata,193,182,0	duplicate(Gravestone#SS2)	Gravestone#1F_5F	844
1@cata,253,156,0	duplicate(Gravestone#SS2)	Gravestone#1F_6F	844
1@cata,88,154,0	duplicate(Gravestone#SS2)	Gravestone#1F_7F	844
1@cata,127,116,0	duplicate(Gravestone#SS2)	Gravestone#1F_8F	844
1@cata,90,98,0	duplicate(Gravestone#SS2)	Gravestone#1F_9F	844
1@cata,188,84,0	duplicate(Gravestone#SS2)	Gravestone#1F_10F	844
1@cata,244,42,0	duplicate(Gravestone#SS2)	Gravestone#1F_11F	844
1@cata,127,32,0	duplicate(Gravestone#SS2)	Gravestone#1F_12F	844
1@cata,267,30,0	duplicate(Gravestone#SS2)	Gravestone#1F_13F	844

// Bobbing Torches
//============================================================
-	script	Bobbing Torch#SS	-1,{
	set .@party_id,getcharid(1);
	if (getpartyleader(.@party_id,2) == getcharid(0)) {
		if (('ins_baphomet == 3) && (countitem(6001) < 11)) {
			mes "A huge torch appearing as if it can burn everything is bobbing up and down in front of me.";
			next;
			mes "The grand appearance and heat of the fire makes me step back... But I pluck up my courage and reach out to pick up the torch.";
			next;
			specialeffect2 EF_HOLYHIT;
			getitem 6001,1; //Essence_Of_Fire
			mes "The symbol of inheritor shines. Then a small crystal falls into my hand from the torch.";
			disablenpc instance_npcname(strnpcinfo(0));
			close;
		}
		else if (('ins_baphomet == 3) && (countitem(6001) > 10)) {
			mes "You have 10 Essence of Fire already, so you don't need to collect any more.";
			close;
		}
		else {
			mes "You don't need to collect Essence of Fire anymore.";
			close;
		}
	}
	else {
		mes "A huge torch appearing as if it can burn everything is bobbing up and down in front of me..";
		next;
		mes "[Unknown Voice]";
		mes "You are not a inheritor of faith. Do not desecrate the Essence of Fire with your disrespectful hands.";
		specialeffect2 EF_FIRESPLASHHIT;
		percentheal -50,0;
		close;
	}

OnInstanceInit:
	disablenpc instance_npcname(strnpcinfo(0));
	end;
}
1@cata,267,210,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#1	844
1@cata,85,182,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#2	844
1@cata,267,154,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#3	844
1@cata,157,139,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#4	844
1@cata,193,138,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#5	844
1@cata,193,102,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#6	844
1@cata,157,102,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#7	844
1@cata,113,112,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#8	844
1@cata,253,56,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#9	844
1@cata,239,56,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#10	844
1@cata,71,42,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#11	844
1@cata,155,14,0	duplicate(Bobbing Torch#SS)	Bobbing Torch#12	844

1@cata,1,1,0	script	ins_baphomet_1f_timer	-1,{
OnInstanceInit:
	disablenpc instance_npcname("ins_baphomet_1f_timer");
	end;

OnEnable:
	enablenpc instance_npcname("ins_baphomet_1f_timer");
	initnpctimer;
	end;

OnDisable:
	disablenpc instance_npcname("ins_baphomet_1f_timer");
	stopnpctimer;
	end;

OnTimer1800000:
	mapannounce instance_mapname("1@cata"), "Alma do Heroi Antigo : We don't have enough time! Hurry up!",bc_map,"0xFFFF00";
	end;

OnTimer2400000:
	mapannounce instance_mapname("1@cata"), "Alma do Heroi Antigo : My body is disappearing... Hurry up!",bc_map,"0xFFFF00";
	end;

OnTimer3000000:
	mapannounce instance_mapname("1@cata"), "Alma do Heroi Antigo : Everything is over... There is no other way but to wait for the next chance...",bc_map,"0xFFFF00";
	end;

OnTimer3050000:
	mapannounce instance_mapname("1@cata"), "Alma do Heroi Antigo : We failed... However... We still have a chance. I hope you will train yourselves until the time comes.",bc_map,"0xFFFF00";
	end;

OnTimer3100000:
	mapannounce instance_mapname("1@cata"), "You've failed to open the seal of main altar.",bc_map,"0xFFFF00";
	end;

OnTimer3500000:
	instance_warpall "monk_test",310,150;
	stopnpctimer;
	end;
}

2@cata,80,144,0	script	ins_2f_enter	-1,3,3,{
OnTouch_:
	donpcevent instance_npcname("ins_2f_enter_broad")+"::OnEnable";
	disablenpc instance_npcname("ins_2f_enter");
	end;
}

2@cata,1,1,0	script	ins_2f_enter_broad	-1,{
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname("ins_2f_enter_broad");
	end;

OnEnable:
	enablenpc instance_npcname("ins_2f_enter_broad");
	initnpctimer;
	end;

OnTimer10000:
	mapannounce instance_mapname("2@cata"), "Baphomet : Humans... interfering again...",bc_map,"0xdb7093";
	end;

OnTimer13000:
	mapannounce instance_mapname("2@cata"), "Apóstolo de Baphomet : Humans! Humans have invaded our sanctum!",bc_map,"0xFFFF00";
	end;

OnTimer16000:
	mapannounce instance_mapname("2@cata"), "Apóstolo de Baphomet : Kill the humans! Do not stop the revival of our Master!",bc_map,"0xFFFF00";
	end;

OnTimer18000:
	mapannounce instance_mapname("2@cata"), "Apóstolo de Baphomet : Hurry up and release the seals of the altars! Our Master's return is upon us!",bc_map,"0xFFFF00";
	stopnpctimer;
	disablenpc instance_npcname("ins_2f_enter_broad");
	end;
}

2@cata,50,67,0	script	slave_left	-1,5,5,{
OnTouch_:
	set .@map$, instance_mapname("2@cata");
	mapannounce .@map$, "Apóstolo de Baphomet : Kill the humans! Don't let them interrupt the revival of our Master!",bc_map,"0xFFFF00";
	monster .@map$,55,67,"Apóstolo de Baphomet",1869,1;
	monster .@map$,51,67,"Apóstolo de Baphomet",1291,1;
	monster .@map$,58,67,"Apóstolo de Baphomet",1292,1;
	monster .@map$,53,67,"Apóstolo de Baphomet",1291,1;
	monster .@map$,54,67,"Apóstolo de Baphomet",1869,1;
	monster .@map$,55,67,"Apóstolo de Baphomet",1291,1;
	monster .@map$,56,67,"Apóstolo de Baphomet",1117,1;
	monster .@map$,58,66,"Apóstolo de Baphomet",1869,1;
	monster .@map$,56,66,"Apóstolo de Baphomet",1117,1;
	monster .@map$,60,66,"Apóstolo de Baphomet",1132,1;
	monster .@map$,59,66,"Apóstolo de Baphomet",1117,1;
	monster .@map$,54,66,"Apóstolo de Baphomet",1132,1;
	monster .@map$,55,66,"Apóstolo de Baphomet",1292,1;
	monster .@map$,56,66,"Apóstolo de Baphomet",1132,1;
	monster .@map$,50,65,"Apóstolo de Baphomet",1867,1;
	monster .@map$,61,65,"Apóstolo de Baphomet",1292,1;
	disablenpc instance_npcname("slave_left");
	end;
}

2@cata,109,67,0	script	slave_right	-1,5,5,{
OnTouch_:
	set .@map$, instance_mapname("2@cata");
	mapannounce .@map$, "Apóstolo de Baphomet : Kill the humans! Don't let them interrupt the revival of our Master!",bc_map,"0xFFFF00";
	monster .@map$,105,67,"Apóstolo de Baphomet",1869,1;
	monster .@map$,104,67,"Apóstolo de Baphomet",1291,1;
	monster .@map$,107,67,"Apóstolo de Baphomet",1869,1;
	monster .@map$,106,67,"Apóstolo de Baphomet",1291,1;
	monster .@map$,102,67,"Apóstolo de Baphomet",1869,1;
	monster .@map$,103,67,"Apóstolo de Baphomet",1291,1;
	monster .@map$,103,67,"Apóstolo de Baphomet",1117,1;
	monster .@map$,109,66,"Apóstolo de Baphomet",1117,1;
	monster .@map$,108,66,"Apóstolo de Baphomet",1132,1;
	monster .@map$,101,66,"Apóstolo de Baphomet",1117,1;
	monster .@map$,106,66,"Apóstolo de Baphomet",1292,1;
	monster .@map$,102,66,"Apóstolo de Baphomet",1132,1;
	monster .@map$,104,66,"Apóstolo de Baphomet",1292,1;
	monster .@map$,103,66,"Apóstolo de Baphomet",1132,1;
	monster .@map$,109,65,"Apóstolo de Baphomet",1867,1;
	monster .@map$,108,65,"Apóstolo de Baphomet",1292,1;
	disablenpc instance_npcname("slave_right");
	end;
}

2@cata,79,39,0	script	slave_down	-1,5,5,{
OnTouch_:
	set .@map$, instance_mapname("2@cata");
	mapannounce .@map$, "Apóstolo de Baphomet : Kill the humans! Don't let them interrupt the revival of our Master!",bc_map,"0xFFFF00";
	monster .@map$,78,41,"Apóstolo de Baphomet",1869,1;
	monster .@map$,79,42,"Apóstolo de Baphomet",1291,1;
	monster .@map$,78,46,"Apóstolo de Baphomet",1869,1;
	monster .@map$,81,41,"Apóstolo de Baphomet",1291,1;
	monster .@map$,81,42,"Apóstolo de Baphomet",1869,1;
	monster .@map$,79,43,"Apóstolo de Baphomet",1291,1;
	monster .@map$,77,40,"Apóstolo de Baphomet",1117,1;
	monster .@map$,79,41,"Apóstolo de Baphomet",1132,1;
	monster .@map$,79,42,"Apóstolo de Baphomet",1117,1;
	monster .@map$,79,43,"Apóstolo de Baphomet",1132,1;
	monster .@map$,79,48,"Apóstolo de Baphomet",1117,1;
	monster .@map$,78,49,"Apóstolo de Baphomet",1132,1;
	monster .@map$,78,41,"Apóstolo de Baphomet",1292,1;
	monster .@map$,74,42,"Apóstolo de Baphomet",1292,1;
	monster .@map$,72,48,"Apóstolo de Baphomet",1867,1;
	monster .@map$,72,38,"Apóstolo de Baphomet",1292,1;
	disablenpc instance_npcname("slave_down");
	end;
}

// Magical Seals
//============================================================
-	script	Magical Seal#SS	-1,{
	set .@seal_check,checkquest(3041,PLAYTIME);
	if (.@seal_check == 0 || .@seal_check == 1) {
		specialeffect2 EF_SILENCEATTACK;
		percentheal -50,0;
		sc_start Eff_Stone,30000,0;
		mes "Your SP has not recovered yet. You lost your SP on the altar, but it seems the power of the seal has returned.";
		close;
	}
	if (.@seal_check == 2) erasequest 3041;
	specialeffect EF_LEXDIVINA;
	disablenpc instance_npcname(strnpcinfo(0));
	set .@map$, instance_mapname("2@cata");
	if (strnpcinfo(2) == "0") areamobuseskill .@map$,79,81,10,1929,"NPC_INVINCIBLEOFF",1,0,0,ET_HELP,0;
	else if (strnpcinfo(2) == "2") areamobuseskill .@map$,123,109,10,1929,"NPC_INVINCIBLEOFF",1,0,0,ET_HELP,0;
	else if (strnpcinfo(2) == "4") areamobuseskill .@map$,123,22,10,1929,"NPC_INVINCIBLEOFF",1,0,0,ET_HELP,0;
	else if (strnpcinfo(2) == "8") areamobuseskill .@map$,35,21,10,1929,"NPC_INVINCIBLEOFF",1,0,0,ET_HELP,0;
	else if (strnpcinfo(2) == "10") areamobuseskill .@map$,35,109,10,1929,"NPC_INVINCIBLEOFF",1,0,0,ET_HELP,0;
	percentheal -50,0;
	sc_start Eff_Stone,20000,0;
	setquest 3041;
	mapannounce .@map$, "The seal activated by putting magical power into the altar.",bc_map,"0x87ceeb";
	mes "I can feel the power of the altar came back by adding magical power.";
	next;
	mes "But you can't use your magic for 3 minutes because you used your SP on the altar.";
	close;

OnInstanceInit:
	disablenpc instance_npcname(strnpcinfo(0));
	end;
}
2@cata,79,81,0	duplicate(Magical Seal#SS)	Magical Seal#0	844
2@cata,123,109,0	duplicate(Magical Seal#SS)	Magical Seal#2	844
2@cata,123,22,0	duplicate(Magical Seal#SS)	Magical Seal#4	844
2@cata,35,21,0	duplicate(Magical Seal#SS)	Magical Seal#8	844
2@cata,35,109,0	duplicate(Magical Seal#SS)	Magical Seal#10	844

2@cata,79,65,0	script	The Main Altar#ss	844,{
	set .@party_id,getcharid(1);
	if (('ins_baphomet == 5) && (getpartyleader(.@party_id,2) == getcharid(0))) {
		mes "An evil power, too terrible to describe, lies under the great altar radiating a violet color.";
		next;
		mes "Complicated Magical Rune letters blink rapidly, attempting to suppress the dreadful power within.";
		next;
		mes "The bottom of the Main Altar trembles furiously.";
		next;
		specialeffect EF_METEORSTORM;
		specialeffect EF_METEORSTORM;
		mes "[" + strcharinfo(0) + "]";
		mes "Watch out! Something... Something is coming.";
		set 'ins_baphomet,6;
		donpcevent instance_npcname("ins_2f_hero_broad")+"::OnEnable";
		disablenpc instance_npcname("The Main Altar#ss");
		close;
	}
	else {
		mes "An evil power, too terrible to describe, lies under the great altar radiating a violet color.";
		next;
		mes "Complicated Magical Rune letters blink rapidly, attempting to suppress the dreadful power within.";
		close;
	}
	end;
}

2@cata,80,63,4	script	Alma do Heroi Antigo#2F	411,{
	cutin "ins_cata_champ_s",2;
	if (checkquest(3041)>=0) erasequest 3041;
	mes "[Alma do Heroi Antigo]";
	mes "Good job, my descendants... You've finished the long-cherished task that me and my bretheren could not complete.";
	next;
	mes "[Alma do Heroi Antigo]";
	mes "I really appreciate your help.";
	mes "Our souls can finally rest in peace...";
	next;
	mes "[Alma do Heroi Antigo]";
	mes "The struggle for peace on this world will never end. But... my role here is finally over because there are brave heroes like you.";
	next;
	switch(select("Let me leave the shrine.:Stop talking.")) {
	case 1:
		mes "[Alma do Heroi Antigo]";
		mes "Okay. I'll let you and your group leave here safely.";
		next;
		mes "[Alma do Heroi Antigo]";
		mes "If you leave, please say hello to Patrick for me.";
		cutin "",255;
		set 'ins_baphomet,0;
		warp "monk_test",310,150;
		close;
	case 2:
		mes "[Alma do Heroi Antigo]";
		mes "Do you still have something to do here? If you're done I'll let you leave safely...";
		cutin "",255;
		close;
	}

OnInstanceInit:
	disablenpc instance_npcname("Alma do Heroi Antigo#2F");
	end;
}

2@cata,1,2,0	script	ins_2f_hero_broad	-1,{
OnEnable:
	enablenpc instance_npcname("ins_2f_hero_broad");
	initnpctimer;
	end;

OnDisable:
	disablenpc instance_npcname("ins_2f_hero_broad");
	end;

OnTimer3000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : My God! The seal of the Main Altar is weakening!",bc_map,"0xFFFF00";
	end;

OnTimer6000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : My descendants... Listen carefully to what I'm going to say.",bc_map,"0xFFFF00";
	end;

OnTimer9000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : The altars that control the Main Altar's power are located in the Northeast, Southeast, Southwest and Northwest corners of this room.",bc_map,"0xFFFF00";
	end;

OnTimer12000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : Find these altars and activate their seals before Baphomet revives.",bc_map,"0xFFFF00";
	end;

OnTimer15000:
	mapannounce instance_mapname("2@cata"), "Baphomet : It's too late, weaklings... Now, you'll feel the despair of death!",bc_map,"0xdb7093";
	end;

OnTimer17000:
	mapannounce instance_mapname("2@cata"), "Baphomet : No one can harm me here. You will be my first sacrifice.",bc_map,"0xdb7093";
	donpcevent instance_npcname("control_baphomet")+"::OnEnable";
	donpcevent instance_npcname("ins_2f_hero_broad2")+"::OnEnable";
	stopnpctimer;
	disablenpc instance_npcname("ins_2f_hero_broad");
	end;
}

2@cata,3,3,0	script	control_baphomet	-1,{
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname("control_baphomet");
	end;

OnEnable:
	enablenpc instance_npcname("control_baphomet");
	donpcevent instance_npcname("2f_callmon_pattern_c")+"::OnEnable";
	monster instance_mapname("2@cata"),79,64,"Baphomet#",1929,1,instance_npcname("control_baphomet")+"::OnMyMobDead";
	end;

OnMyMobDead:
	set .@map$, instance_mapname("2@cata");
	if (mobcount(.@map$,instance_npcname("control_baphomet")+"::OnMyMobDead") < 1) {
		set 'ins_baphomet,7;
		if (isbegin_quest(3041))
			erasequest 3041;
		mapannounce .@map$, "Baphomet : No! Nonono! How dare these weaklings defeat me!... No!!...",bc_map,"0xdb7093";
		enablenpc instance_npcname("Alma do Heroi Antigo#2F");
		disablenpc instance_npcname("slave_down");
		disablenpc instance_npcname("slave_left");
		disablenpc instance_npcname("slave_right");
		donpcevent instance_npcname("ins_2f_hero_broad")+"::OnDisable";
		donpcevent instance_npcname("ins_2f_hero_broad2")+"::OnDisable";
		donpcevent instance_npcname("ins_2f_hero_pattern_c")+"::OnDisable";
		donpcevent instance_npcname("2f_callmon_pattern_c")+"::OnDisable";
		donpcevent instance_npcname("2f_callmon_pattern")+"::OnDisable";
		donpcevent instance_npcname("ins_2f_hero_pattern")+"::OnDisable";
		donpcevent instance_npcname("ins_2f_enter_broad")+"::OnDisable";
		donpcevent instance_npcname("control_baphomet")+"::OnDisable";
		disablenpc instance_npcname("control_baphomet");
	}
	end;
}

2@cata,2,2,0	script	ins_2f_hero_broad2	-1,{
OnInstanceInit:
OnDisable:
	disablenpc instance_npcname("ins_2f_hero_broad2");
	end;

OnEnable:
	enablenpc instance_npcname("ins_2f_hero_broad2");
	initnpctimer;
	end;

OnTimer8000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : Não desanime, Baphomet ainda pode ser derrotado!",bc_map,"0xFFFF00";
	end;

OnTimer11000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : Vá aos altares e ative seus selos.",bc_map,"0xFFFF00";
	end;

OnTimer13000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : Quando os selos recuperarem seu poder, Baphomet ficará vulnerável.",bc_map,"0xFFFF00";
	end;

OnTimer16000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : Você deve atrair Baphomet para os Altares sem lacre. Caso contrário, seus esforços serão inúteis.",bc_map,"0xFFFF00";
	end;

OnTimer19000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : Temos apenas 1 hora para parar o Baphomet. Se o tempo acabar, o poder dos selos será inútil.",bc_map,"0xFFFF00";
	end;

OnTimer22000:
	mapannounce instance_mapname("2@cata"), "Baphomet : É inútil. Fazer mais selos. Eu vou esmagar todos eles. Nenhum de vocês vai sobreviver!",bc_map,"0xdb7093";
	end;

OnTimer26000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : O poder mágico do selo central está acabando. Vá para o selo central e coloque o poder mágico.",bc_map,"0xFFFF00";
	enablenpc instance_npcname("Magical Seal#0");
	disablenpc instance_npcname("Magical Seal#2");
	disablenpc instance_npcname("Magical Seal#4");
	disablenpc instance_npcname("Magical Seal#8");
	disablenpc instance_npcname("Magical Seal#10");
	donpcevent instance_npcname("ins_2f_hero_pattern_c")+"::OnEnable";
	stopnpctimer;
	disablenpc instance_npcname("ins_2f_hero_broad2");
	end;
}

2@cata,4,1,0	script	2f_callmon_pattern_c	-1,{
OnInstanceInit:
	disablenpc instance_npcname("2f_callmon_pattern_c");
	end;

OnEnable:
	enablenpc instance_npcname("2f_callmon_pattern_c");
	initnpctimer;
	donpcevent instance_npcname("2f_callmon_pattern_c")+"::Ongo";
	end;

OnDisable:
	stopnpctimer;
	disablenpc instance_npcname("2f_callmon_pattern_c");
	end;

Ongo:
	donpcevent instance_npcname("2f_callmon_pattern")+"::OnEnable";
	end;

OnTimer3600000:
	donpcevent instance_npcname("2f_callmon_pattern_c")+"::OnDisable";
	end;
}

2@cata,4,2,0	script	2f_callmon_pattern	-1,{
OnInstanceInit:
	disablenpc instance_npcname("2f_callmon_pattern");
	end;

OnEnable:
	enablenpc instance_npcname("2f_callmon_pattern");
	stopnpctimer;
	initnpctimer;
	end;

OnDisable:
	disablenpc instance_npcname("2f_callmon_pattern");
	stopnpctimer;
	end;

OnTimer300000:
	enablenpc instance_npcname("slave_down");
	enablenpc instance_npcname("slave_left");
	enablenpc instance_npcname("slave_right");
	donpcevent instance_npcname("2f_callmon_pattern_c")+"::Ongo";
	end;
}

2@cata,3,1,0	script	ins_2f_hero_pattern_c	-1,{
OnInstanceInit:
	disablenpc instance_npcname("ins_2f_hero_pattern_c");
	end;

OnEnable:
	enablenpc instance_npcname("ins_2f_hero_pattern_c");
	initnpctimer;
	donpcevent instance_npcname("ins_2f_hero_pattern_c")+"::Ongo";
	end;

Ongo:
	donpcevent instance_npcname("ins_2f_hero_pattern")+"::OnEnable";
	end;

OnDisable:
	stopnpctimer;
	disablenpc instance_npcname("Magical Seal#0");
	disablenpc instance_npcname("Magical Seal#2");
	disablenpc instance_npcname("Magical Seal#4");
	disablenpc instance_npcname("Magical Seal#8");
	disablenpc instance_npcname("Magical Seal#10");
	donpcevent instance_npcname("ins_2f_hero_pattern")+"::OnDisable";
	disablenpc instance_npcname("ins_2f_hero_pattern_c");
	end;

OnTimer3600000:
	mapannounce instance_mapname("2@cata"), "Baphomet : krrrr... Agora você não pode me parar com os selos. Tudo o que você pode fazer é esperar pela morte!",bc_map,"0xdb7093";
	end;

OnTimer3605000:
	mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : Nós não podemos mais parar Baphomet com o poder mágico dos selos. Agora tudo depende de Deus...",bc_map,"0xFFFF00";
	donpcevent instance_npcname("ins_2f_hero_pattern_c")+"::OnDisable";
	end;
}

2@cata,3,2,0	script	ins_2f_hero_pattern	-1,{
OnInstanceInit:
	disablenpc instance_npcname("ins_2f_hero_pattern");
	end;

OnEnable:
	enablenpc instance_npcname("ins_2f_hero_pattern");
	initnpctimer;
	end;

OnDisable:
	disablenpc instance_npcname("ins_2f_hero_pattern");
	stopnpctimer;
	end;

OnTimer70000:
	switch(rand(1,5)) {
	case 1:
		mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : O selo do Altar Principal está acabando. Fortalecer o selo do Altar Principal!",bc_map,"0xFFFF00";
		enablenpc instance_npcname("Magical Seal#0");
		disablenpc instance_npcname("Magical Seal#2");
		disablenpc instance_npcname("Magical Seal#4");
		disablenpc instance_npcname("Magical Seal#8");
		disablenpc instance_npcname("Magical Seal#10");
		break;
	case 2:
		mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : O poder mágico do selo às 2 horas está acabando. Vá para as 2 horas e coloque o poder mágico no selo.",bc_map,"0xFFFF00";
		disablenpc instance_npcname("Magical Seal#0");
		enablenpc instance_npcname("Magical Seal#2");
		disablenpc instance_npcname("Magical Seal#4");
		disablenpc instance_npcname("Magical Seal#8");
		disablenpc instance_npcname("Magical Seal#10");
		break;
	case 3:
		mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : O poder mágico do selo às 4 horas está acabando. Vá às 4 horas e coloque o poder mágico no selo.",bc_map,"0xFFFF00";
		disablenpc instance_npcname("Magical Seal#0");
		disablenpc instance_npcname("Magical Seal#2");
		enablenpc instance_npcname("Magical Seal#4");
		disablenpc instance_npcname("Magical Seal#8");
		disablenpc instance_npcname("Magical Seal#10");
		break;
	case 4:
		mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : O poder mágico do selo às 8 horas está acabando. Vá às 8 horas e coloque o poder mágico no selo.",bc_map,"0xFFFF00";
		disablenpc instance_npcname("Magical Seal#0");
		disablenpc instance_npcname("Magical Seal#2");
		disablenpc instance_npcname("Magical Seal#4");
		enablenpc instance_npcname("Magical Seal#8");
		disablenpc instance_npcname("Magical Seal#10");
		break;
	case 5:
		mapannounce instance_mapname("2@cata"), "Alma do Heroi Antigo : O poder mágico do selo às 10 horas está acabando. Vá às 10 horas e coloque o poder mágico no selo.",bc_map,"0xFFFF00";
		disablenpc instance_npcname("Magical Seal#0");
		disablenpc instance_npcname("Magical Seal#2");
		disablenpc instance_npcname("Magical Seal#4");
		disablenpc instance_npcname("Magical Seal#8");
		enablenpc instance_npcname("Magical Seal#10");
	}
	stopnpctimer;
	donpcevent instance_npcname("ins_2f_hero_pattern_c")+"::Ongo";
	end;
}


1@cata,1,1,0	script	ins_1f_spawn_mobs	-1,{
OnInstanceInit:
	set .@map$, instance_mapname("1@cata");
	monster .@map$,0,0,"Zumbi Mestre",1298,10;
	monster .@map$,0,0,"Aparição",1291,10;
	//monster .@map$,0,0,"Mímico Antigo",1699,10;
	monster .@map$,0,0,"Crânio Flamejante",1869,10;
	monster .@map$,0,0,"Esqueleto General",1290,10;
	monster .@map$,0,0,"Zumbi Mestre",1298,10;
	monster .@map$,0,0,"Esqueleto General",1290,10;
	monster .@map$,0,0,"Crânio Flamejante",1869,10;
	monster .@map$,0,0,"Aparição",1291,10;
	monster .@map$,0,0,"Aparição",1291,10;
	monster .@map$,0,0,"Khalitzburg",1132,10;
	monster .@map$,0,0,"Khalitzburg",1132,10;
	monster .@map$,0,0,"Crânio Flamejante",1869,10;
	monster .@map$,0,0,"Crânio Flamejante",1869,10;
	monster .@map$,0,0,"Mímico Antigo",1699,10;
	monster .@map$,0,0,"Zumbi Mestre",1298,10;
	monster .@map$,0,0,"Mímico Antigo",1699,10;
	monster .@map$,0,0,"Zumbi Mestre",1298,10;
	monster .@map$,0,0,"Aparição",1291,10;
	monster .@map$,0,0,"Esqueleto General",1290,10;
	monster .@map$,0,0,"Esqueleto General",1290,10;
	monster .@map$,0,0,"Xamã do Vento",1263,10;
	monster .@map$,0,0,"Xamã do Vento",1263,10;
	monster .@map$,0,0,"Xamã do Vento",1263,10;
	monster .@map$,0,0,"Lude",1509,10;
	monster .@map$,0,0,"Lude",1509,10;
	monster .@map$,0,0,"Druida Malígno",1117,10;
	monster .@map$,0,0,"Druida Malígno",1117,10;
	monster .@map$,0,0,"Druida Malígno",1117,10;
	monster .@map$,0,0,"Banshee",1867,10;
	monster .@map$,0,0,"Ilusão das Trevas",1302,1;
	disablenpc instance_npcname("ins_1f_spawn_mobs");
	end;
}
